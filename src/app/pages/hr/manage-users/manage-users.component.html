<div
  class="flex flex-col items-center justify-start min-h-screen bg-gray-50 pt-10 arabic-text"
>
  <!-- Main Card -->
  <div class="w-full max-w-7xl bg-white shadow-lg p-8 rounded-lg">
    <!-- Header -->
    <div
      class="bg-primary text-white text-center py-4 rounded-t-lg -mx-8 -mt-8 mb-8"
    >
      <h2 class="block text-3xl font-sans arabic-text">إدارة المستخدمين</h2>
    </div>

    <!-- Controls -->
    <div class="flex justify-between items-center mb-6">
      <!-- Filter Inputs -->
      <div class="flex gap-4">
        <input
          type="text"
          [(ngModel)]="filters.name"
          placeholder="الاسم"
          class="w-full px-6 py-3 border-b-2 border-gray-300 rounded-lg shadow-sm focus:outline-none focus:bg-white hover:bg-slate-100 arabic-text"
        />
        <input
          type="text"
          [(ngModel)]="filters.fingerCode"
          placeholder=" كود البصمة"
          class="w-full px-6 py-3 border-b-2 border-gray-300 rounded-lg shadow-sm focus:outline-none focus:bg-white hover:bg-slate-100 arabic-text"
        />
      </div>
      <!-- Add Button -->
      <button
        (click)="addUser()"
        class="bg-primary text-white py-3 px-6 rounded-lg hover:bg-primary/80 arabic-text whitespace-nowrap"
      >
        إضافة مستخدم
      </button>
    </div>

    <!-- Content: Table and Details -->
    <div class="flex gap-6">
      <!-- Table Section -->
      <div class="w-[75%]">
        <div
          class="overflow-hidden rounded-lg shadow-sm border border-gray-200"
        >
          <div *ngIf="loading" class="text-center p-8 arabic-text">
            جاري التحميل...
          </div>
          <div *ngIf="error" class="text-center p-8 text-red-500 arabic-text">
            {{ error }}
          </div>
          <table class="min-w-full" *ngIf="!loading && !error">
            <thead class="bg-primary text-white">
              <tr>
                <th class="py-3 px-6 text-right font-semibold arabic-text">
                  الاسم
                </th>
                <th class="py-3 px-6 text-right font-semibold arabic-text">
                  كود البصمة
                </th>
                <th class="py-3 px-6 text-right font-semibold arabic-text">
                  البريد الإلكتروني
                </th>
                <th class="py-3 px-6 text-center font-semibold arabic-text">
                  الإجراءات
                </th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
              <tr
                *ngFor="let user of filteredUsers()"
                (click)="selectUser(user)"
                class="hover:bg-gray-50 cursor-pointer"
                [class.bg-gray-100]="selectedUser?.id === user.id"
              >
                <td class="py-3 px-6 arabic-text">
                  {{ user.nameE || user.NameE }}
                </td>
                <td class="py-3 px-6 arabic-text">
                  {{ user.fingerCode }}
                </td>
                <td class="py-3 px-6 arabic-text">
                  {{ user.email || user.Email }}
                </td>
                <td class="py-3 px-6 flex items-center justify-center gap-2">
                  <button
                    (click)="editUser(user); $event.stopPropagation()"
                    class="p-2 rounded-full text-cyan-700 hover:bg-cyan-50 transition-colors"
                    title="تعديل"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 24 24"
                      class="w-5 h-5"
                    >
                      <path
                        fill="none"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="m14.304 4.844l2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565l6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
                      ></path>
                    </svg>
                  </button>
                  <button
                    (click)="softDeleteUser(user); $event.stopPropagation()"
                    class="p-2 rounded-full text-red-600 hover:bg-red-50 transition-colors"
                    title="حذف"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 24 24"
                      class="w-5 h-5"
                    >
                      <path
                        fill="currentColor"
                        d="M5 21V6H4V4h5V3h6v1h5v2h-1v15zm2-2h10V6H7zm2-2h2V8H9zm4 0h2V8h-2zM7 6v13z"
                      ></path>
                    </svg>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Details Section -->
      <div class="w-[25%]">
        <div
          *ngIf="selectedUser"
          class="bg-slate-50 rounded-lg shadow-sm border border-gray-200 p-6 h-full"
        >
          <h3 class="text-xl font-bold mb-4 arabic-text text-primary">
            {{ selectedUser.nameE || selectedUser.NameE }}
          </h3>
          <p class="arabic-text">
            <span class="font-semibold">البريد الإلكتروني:</span>
            {{ selectedUser.email || selectedUser.Email }}
          </p>
          <p class="arabic-text">
            <span class="font-semibold">كود البصمة:</span>
            {{ selectedUser.fingerCode }}
          </p>
          <p class="arabic-text">
            <span class="font-semibold">رقم الموظف:</span>
            {{ selectedUser.id || selectedUser.Id }}
          </p>
          <!-- Add more fields as needed -->
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Registration Modal -->
<div
  *ngIf="showRegisterModal"
  class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"
  (click)="closeRegisterModal()"
>
  <div (click)="$event.stopPropagation()">
    <app-register (closeModal)="closeRegisterModal()"></app-register>
  </div>
</div>

<!-- Edit User Modal -->
<app-edit-user-modal
  *ngIf="showEditModal"
  [user]="userToEdit"
  (close)="closeEditModal()"
  (save)="saveUser($event)"
></app-edit-user-modal>

<!-- Delete User Modal -->
<app-delete-user-modal
  *ngIf="showDeleteModal"
  [user]="userToDelete"
  (close)="closeDeleteModal()"
  (confirm)="confirmDelete()"
></app-delete-user-modal>
